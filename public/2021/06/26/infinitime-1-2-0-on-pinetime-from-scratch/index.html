<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Infinitime 1.2-0 on PineTime, from scratch | Lopeztel&#39;s Blog</title>
<meta name="keywords" content="100DaysToOffload, nrf52, pinetime">
<meta name="description" content="It seems that it is normal for me to buy stuff/parts/devkits and let them accumulate some dust before getting back to the project pile …
Just recently I read on the Pine64 Blog June update that Infinitime 1.2 was coming soon… Then I remembered I had ordered a PineTime devkit (part of the first batch ever actually) so I decided to find it and flash working firmware on it…
I attempted to flash it with a STM bluepill Black Magic Probe first:Image taken from this forum thread">
<meta name="author" content="lopeztel">
<link rel="canonical" href="https://lopeztel.xyz/blog/2021/06/26/infinitime-1-2-0-on-pinetime-from-scratch/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.b183800e2cfbb62c3bce2b2ba56cdb2dd33af76c75cf4550173d5dfebd7c68a6.css" integrity="sha256-sYOADiz7tiw7zisrpWzbLdM692x1z0VQFz1d/r18aKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://lopeztel.xyz/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lopeztel.xyz/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lopeztel.xyz/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lopeztel.xyz/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://lopeztel.xyz/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Infinitime 1.2-0 on PineTime, from scratch" />
<meta property="og:description" content="It seems that it is normal for me to buy stuff/parts/devkits and let them accumulate some dust before getting back to the project pile …
Just recently I read on the Pine64 Blog June update that Infinitime 1.2 was coming soon… Then I remembered I had ordered a PineTime devkit (part of the first batch ever actually) so I decided to find it and flash working firmware on it…
I attempted to flash it with a STM bluepill Black Magic Probe first:Image taken from this forum thread" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lopeztel.xyz/blog/2021/06/26/infinitime-1-2-0-on-pinetime-from-scratch/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-26T19:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-06-26T19:00:00&#43;00:00" /><meta property="og:site_name" content="Lopeztel&#39;s blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Infinitime 1.2-0 on PineTime, from scratch"/>
<meta name="twitter:description" content="It seems that it is normal for me to buy stuff/parts/devkits and let them accumulate some dust before getting back to the project pile …
Just recently I read on the Pine64 Blog June update that Infinitime 1.2 was coming soon… Then I remembered I had ordered a PineTime devkit (part of the first batch ever actually) so I decided to find it and flash working firmware on it…
I attempted to flash it with a STM bluepill Black Magic Probe first:Image taken from this forum thread"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://lopeztel.xyz/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Infinitime 1.2-0 on PineTime, from scratch",
      "item": "https://lopeztel.xyz/blog/2021/06/26/infinitime-1-2-0-on-pinetime-from-scratch/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Infinitime 1.2-0 on PineTime, from scratch",
  "name": "Infinitime 1.2-0 on PineTime, from scratch",
  "description": "It seems that it is normal for me to buy stuff/parts/devkits and let them accumulate some dust before getting back to the project pile …\nJust recently I read on the Pine64 Blog June update that Infinitime 1.2 was coming soon… Then I remembered I had ordered a PineTime devkit (part of the first batch ever actually) so I decided to find it and flash working firmware on it…\nI attempted to flash it with a STM bluepill Black Magic Probe first:Image taken from this forum thread",
  "keywords": [
    "100DaysToOffload", "nrf52", "pinetime"
  ],
  "articleBody": "It seems that it is normal for me to buy stuff/parts/devkits and let them accumulate some dust before getting back to the project pile …\nJust recently I read on the Pine64 Blog June update that Infinitime 1.2 was coming soon… Then I remembered I had ordered a PineTime devkit (part of the first batch ever actually) so I decided to find it and flash working firmware on it…\nI attempted to flash it with a STM bluepill Black Magic Probe first:Image taken from this forum thread\nGuide to program using arm-noneabi-gdb and BMP here\nApparently I managed to delete the application firmware because the dummy GUI that showed the charging state was gone…but I didn’t manage to make it show anything, I was left with a paperweight, just for fun, here’s the log:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74  ╰─ arm-none-eabi-gdb ─╯ GNU gdb (GDB) 10.2 Copyright (C) 2021 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later \u0026lt;http://gnu.org/licenses/gpl.html\u0026gt; This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Type \"show copying\" and \"show warranty\" for details. This GDB was configured as \"--host=x86_64-pc-linux-gnu --target=arm-none-eabi\". Type \"show configuration\" for configuration details. For bug reporting instructions, please see: \u0026lt;https://www.gnu.org/software/gdb/bugs/\u0026gt;. Find the GDB manual and other documentation resources online at: \u0026lt;http://www.gnu.org/software/gdb/documentation/\u0026gt;. For help, type \"help\". Type \"apropos word\" to search for commands related to \"word\". (gdb) target extended-remote /dev/ttyACM0 Remote debugging using /dev/ttyACM0 (gdb) monitor swdp_scan Target voltage: 2.96V Available Targets: No. Att Driver 1 Nordic nRF52 M4 2 Nordic nRF52 Access Port (gdb) attach 1 Attaching to Remote target warning: No executable has been specified and target does not support determining executable automatically. Try using the \"file\" command. 0xfffffffe in ?? () (gdb) mon erase_mass erase.. (gdb) mon hard_srst (gdb) detach Detaching from program: , Remote target \u0026#91;Inferior 1 (Remote target) detached] (gdb) monitor swdp_scan Target voltage: 2.94V Available Targets: No. Att Driver 1 Nordic nRF52 M4 2 Nordic nRF52 Access Port (gdb) attach 1 Attaching to Remote target warning: No executable has been specified and target does not support determining executable automatically. Try using the \"file\" command. 0xfffffffe in ?? () (gdb) file ~/Downloads/Infinitime/1.2.0/merged-internal.hex A program is being debugged already. Are you sure you want to change the file? (y or n) y Reading symbols from ~/Downloads/Infinitime/1.2.0/merged-internal.hex... (No debugging symbols found in ~/Downloads/Infinitime/1.2.0/merged-internal.hex) (gdb) load Loading section .sec1, size 0x54a0 lma 0x0 Loading section .sec2, size 0x8000 lma 0x8000 Loading section .sec3, size 0x10000 lma 0x10000 Loading section .sec4, size 0x10000 lma 0x20000 Loading section .sec5, size 0x10000 lma 0x30000 Loading section .sec6, size 0x10000 lma 0x40000 Loading section .sec7, size 0x9970 lma 0x50000 Start address 0x00000000, load size 355856 Transfer rate: 39 KB/sec, 969 bytes/write. (gdb) compare-sections Section .sec1, range 0x0 -- 0x54a0: matched. Section .sec2, range 0x8000 -- 0x10000: matched. Section .sec3, range 0x10000 -- 0x20000: matched. Section .sec4, range 0x20000 -- 0x30000: matched. Section .sec5, range 0x30000 -- 0x40000: matched. Section .sec6, range 0x40000 -- 0x50000: matched. Section .sec7, range 0x50000 -- 0x59970: matched. (gdb) mon hard_srst (gdb) detach Detaching from program: /home/lopeztel/Downloads/Infinitime/1.2.0/merged-internal.hex, Remote target \u0026#91;Inferior 1 (Remote target) detached] (gdb) quit   After consulting with the guys at the PineTime-dev Matrix channel, I was glad to confirm I was flashing the right file: merged-internal.hex from the releases page in InfiniTime github repo actually contains both the bootloader and the application firmware in a single file, so no complaints there…\nBut, someone also pointed out that the first devices to ship had locked bootloaders, so turns out I had to unlock it with a Segger J-Link Debug Probe (aka NRF52DK I had around here)\nPin connections:   Pin on PineTime Pin on NRF52DK P20     SWDIO SWDIO   SWDCLK SWDCLK   3.3V VCC VTG   GND GND DETECT    Then it was just a matter of issuing a couple of nrfjprog commands as stated in the wiki article Reprogramming the PineTime:\n1 2 3  nrfjprog -f NRF52 --recover nrfjprog -f NRF52 --program /merged-internal.hex --sectorerase nrfjprog -f NRF42 -f NRF52 --reset   Which finally did the trick:\nNow, I only need to do something about the stuck button…I attempted to seal the device with superglue and it spilled everywhere\nHuge shoutout to the nice people in the PineTime-dev Matrix channel, they were very patient and helpful!\n Day 14 of my 2020’s #100DaysToOffload\nJoin 100DaysToOffload!\n",
  "wordCount" : "791",
  "inLanguage": "en",
  "datePublished": "2021-06-26T19:00:00Z",
  "dateModified": "2021-06-26T19:00:00Z",
  "author":{
    "@type": "Person",
    "name": "lopeztel"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lopeztel.xyz/blog/2021/06/26/infinitime-1-2-0-on-pinetime-from-scratch/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Lopeztel's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lopeztel.xyz/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lopeztel.xyz/blog" accesskey="h" title="Lopeztel&#39;s Blog (Alt + H)">Lopeztel&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lopeztel.xyz/blog/archives/" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="https://lopeztel.xyz/blog/posts/" title="posts">
                    <span>posts</span>
                </a>
            </li>
            <li>
                <a href="https://lopeztel.xyz/blog/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
            <li>
                <a href="https://lopeztel.xyz/blog/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lopeztel.xyz/blog">Home</a>&nbsp;»&nbsp;<a href="https://lopeztel.xyz/blog/posts/">Posts</a></div>
    <h1 class="post-title">
      Infinitime 1.2-0 on PineTime, from scratch
    </h1>
    <div class="post-meta"><span title='2021-06-26 19:00:00 +0000 +0000'>June 26, 2021</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;lopeztel

</div>
  </header> 

  <div class="post-content"><p>It seems that it is normal for me to buy stuff/parts/devkits and let them accumulate some dust before getting back to the project pile …</p>
<p>Just recently I read on the Pine64 Blog <a href="https://www.pine64.org/2021/06/15/june-update-new-hardware-and-more-on-the-way/">June update</a> that Infinitime 1.2 was coming soon… Then I remembered I had ordered a <a href="https://www.pine64.org/pinetime/">PineTime</a> devkit (part of the first batch ever actually) so I decided to find it and flash working firmware on it…</p>
<p>I attempted to flash it with a <a href="https://github.com/koendv/blackmagic-bluepill">STM bluepill Black Magic Probe</a> first:<!-- raw HTML omitted --></p>
<p><img loading="lazy" src="https://matrix-client.matrix.org/_matrix/media/r0/download/matrix.org/TTthxkqwegUAPqePnQWXjLmC" alt="wiring diagram"  />
 <!-- raw HTML omitted --></p>
<p>Image taken from this <a href="https://forum.pine64.org/showthread.php?tid=8816&amp;pid=57095">forum thread</a></p>
<p>Guide to program using arm-noneabi-gdb and BMP <a href="https://bluetun.serverbox.ch/2020/01/10/flashing-the-nrf52840-with-a-blackmagic-probe-swd-jtag-programmer/">here</a></p>
<p>Apparently I managed to delete the application firmware because the dummy GUI that showed the charging state was gone…but I didn’t manage to make it show anything, I was left with a paperweight, just for fun, here’s the log:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-0-1"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-1"> 1</a>
</span><span class="lnt" id="hl-0-2"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-2"> 2</a>
</span><span class="lnt" id="hl-0-3"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-3"> 3</a>
</span><span class="lnt" id="hl-0-4"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-4"> 4</a>
</span><span class="lnt" id="hl-0-5"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-5"> 5</a>
</span><span class="lnt" id="hl-0-6"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-6"> 6</a>
</span><span class="lnt" id="hl-0-7"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-7"> 7</a>
</span><span class="lnt" id="hl-0-8"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-8"> 8</a>
</span><span class="lnt" id="hl-0-9"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-9"> 9</a>
</span><span class="lnt" id="hl-0-10"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-10">10</a>
</span><span class="lnt" id="hl-0-11"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-11">11</a>
</span><span class="lnt" id="hl-0-12"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-12">12</a>
</span><span class="lnt" id="hl-0-13"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-13">13</a>
</span><span class="lnt" id="hl-0-14"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-14">14</a>
</span><span class="lnt" id="hl-0-15"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-15">15</a>
</span><span class="lnt" id="hl-0-16"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-16">16</a>
</span><span class="lnt" id="hl-0-17"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-17">17</a>
</span><span class="lnt" id="hl-0-18"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-18">18</a>
</span><span class="lnt" id="hl-0-19"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-19">19</a>
</span><span class="lnt" id="hl-0-20"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-20">20</a>
</span><span class="lnt" id="hl-0-21"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-21">21</a>
</span><span class="lnt" id="hl-0-22"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-22">22</a>
</span><span class="lnt" id="hl-0-23"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-23">23</a>
</span><span class="lnt" id="hl-0-24"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-24">24</a>
</span><span class="lnt" id="hl-0-25"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-25">25</a>
</span><span class="lnt" id="hl-0-26"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-26">26</a>
</span><span class="lnt" id="hl-0-27"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-27">27</a>
</span><span class="lnt" id="hl-0-28"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-28">28</a>
</span><span class="lnt" id="hl-0-29"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-29">29</a>
</span><span class="lnt" id="hl-0-30"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-30">30</a>
</span><span class="lnt" id="hl-0-31"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-31">31</a>
</span><span class="lnt" id="hl-0-32"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-32">32</a>
</span><span class="lnt" id="hl-0-33"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-33">33</a>
</span><span class="lnt" id="hl-0-34"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-34">34</a>
</span><span class="lnt" id="hl-0-35"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-35">35</a>
</span><span class="lnt" id="hl-0-36"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-36">36</a>
</span><span class="lnt" id="hl-0-37"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-37">37</a>
</span><span class="lnt" id="hl-0-38"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-38">38</a>
</span><span class="lnt" id="hl-0-39"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-39">39</a>
</span><span class="lnt" id="hl-0-40"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-40">40</a>
</span><span class="lnt" id="hl-0-41"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-41">41</a>
</span><span class="lnt" id="hl-0-42"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-42">42</a>
</span><span class="lnt" id="hl-0-43"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-43">43</a>
</span><span class="lnt" id="hl-0-44"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-44">44</a>
</span><span class="lnt" id="hl-0-45"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-45">45</a>
</span><span class="lnt" id="hl-0-46"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-46">46</a>
</span><span class="lnt" id="hl-0-47"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-47">47</a>
</span><span class="lnt" id="hl-0-48"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-48">48</a>
</span><span class="lnt" id="hl-0-49"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-49">49</a>
</span><span class="lnt" id="hl-0-50"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-50">50</a>
</span><span class="lnt" id="hl-0-51"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-51">51</a>
</span><span class="lnt" id="hl-0-52"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-52">52</a>
</span><span class="lnt" id="hl-0-53"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-53">53</a>
</span><span class="lnt" id="hl-0-54"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-54">54</a>
</span><span class="lnt" id="hl-0-55"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-55">55</a>
</span><span class="lnt" id="hl-0-56"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-56">56</a>
</span><span class="lnt" id="hl-0-57"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-57">57</a>
</span><span class="lnt" id="hl-0-58"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-58">58</a>
</span><span class="lnt" id="hl-0-59"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-59">59</a>
</span><span class="lnt" id="hl-0-60"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-60">60</a>
</span><span class="lnt" id="hl-0-61"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-61">61</a>
</span><span class="lnt" id="hl-0-62"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-62">62</a>
</span><span class="lnt" id="hl-0-63"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-63">63</a>
</span><span class="lnt" id="hl-0-64"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-64">64</a>
</span><span class="lnt" id="hl-0-65"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-65">65</a>
</span><span class="lnt" id="hl-0-66"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-66">66</a>
</span><span class="lnt" id="hl-0-67"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-67">67</a>
</span><span class="lnt" id="hl-0-68"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-68">68</a>
</span><span class="lnt" id="hl-0-69"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-69">69</a>
</span><span class="lnt" id="hl-0-70"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-70">70</a>
</span><span class="lnt" id="hl-0-71"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-71">71</a>
</span><span class="lnt" id="hl-0-72"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-72">72</a>
</span><span class="lnt" id="hl-0-73"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-73">73</a>
</span><span class="lnt" id="hl-0-74"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-0-74">74</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">╰─ arm-none-eabi-gdb                                                         ─╯
</span></span><span class="line"><span class="cl">GNU gdb <span class="o">(</span>GDB<span class="o">)</span> 10.2
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2021</span> Free Software Foundation, Inc.
</span></span><span class="line"><span class="cl">License GPLv3+: GNU GPL version <span class="m">3</span> or later <span class="p">&amp;</span>lt<span class="p">;</span>http://gnu.org/licenses/gpl.html<span class="p">&amp;</span>gt<span class="p">;</span>
</span></span><span class="line"><span class="cl">This is free software: you are free to change and redistribute it.
</span></span><span class="line"><span class="cl">There is NO WARRANTY, to the extent permitted by law.
</span></span><span class="line"><span class="cl">Type <span class="s2">&#34;show copying&#34;</span> and <span class="s2">&#34;show warranty&#34;</span> <span class="k">for</span> details.
</span></span><span class="line"><span class="cl">This GDB was configured as <span class="s2">&#34;--host=x86_64-pc-linux-gnu --target=arm-none-eabi&#34;</span>.
</span></span><span class="line"><span class="cl">Type <span class="s2">&#34;show configuration&#34;</span> <span class="k">for</span> configuration details.
</span></span><span class="line"><span class="cl">For bug reporting instructions, please see:
</span></span><span class="line"><span class="cl"><span class="p">&amp;</span>lt<span class="p">;</span>https://www.gnu.org/software/gdb/bugs/<span class="p">&amp;</span>gt<span class="p">;</span>.
</span></span><span class="line"><span class="cl">Find the GDB manual and other documentation resources online at:
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span>lt<span class="p">;</span>http://www.gnu.org/software/gdb/documentation/<span class="p">&amp;</span>gt<span class="p">;</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For help, <span class="nb">type</span> <span class="s2">&#34;help&#34;</span>.
</span></span><span class="line"><span class="cl">Type <span class="s2">&#34;apropos word&#34;</span> to search <span class="k">for</span> commands related to <span class="s2">&#34;word&#34;</span>.
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> target extended-remote /dev/ttyACM0
</span></span><span class="line"><span class="cl">Remote debugging using /dev/ttyACM0
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> monitor swdp_scan
</span></span><span class="line"><span class="cl">Target voltage: 2.96V
</span></span><span class="line"><span class="cl">Available Targets:
</span></span><span class="line"><span class="cl">No. Att Driver
</span></span><span class="line"><span class="cl"> <span class="m">1</span>      Nordic nRF52 M4
</span></span><span class="line"><span class="cl"> <span class="m">2</span>      Nordic nRF52 Access Port 
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> attach <span class="m">1</span>
</span></span><span class="line"><span class="cl">Attaching to Remote target
</span></span><span class="line"><span class="cl">warning: No executable has been specified and target does not support
</span></span><span class="line"><span class="cl">determining executable automatically.  Try using the <span class="s2">&#34;file&#34;</span> command.
</span></span><span class="line"><span class="cl">0xfffffffe in ?? <span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> mon erase_mass
</span></span><span class="line"><span class="cl">erase..
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> mon hard_srst
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> detach
</span></span><span class="line"><span class="cl">Detaching from program: , Remote target
</span></span><span class="line"><span class="cl"><span class="p">&amp;</span><span class="c1">#91;Inferior 1 (Remote target) detached]</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> monitor swdp_scan
</span></span><span class="line"><span class="cl">Target voltage: 2.94V
</span></span><span class="line"><span class="cl">Available Targets:
</span></span><span class="line"><span class="cl">No. Att Driver
</span></span><span class="line"><span class="cl"> <span class="m">1</span>      Nordic nRF52 M4
</span></span><span class="line"><span class="cl"> <span class="m">2</span>      Nordic nRF52 Access Port 
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> attach <span class="m">1</span>
</span></span><span class="line"><span class="cl">Attaching to Remote target
</span></span><span class="line"><span class="cl">warning: No executable has been specified and target does not support
</span></span><span class="line"><span class="cl">determining executable automatically.  Try using the <span class="s2">&#34;file&#34;</span> command.
</span></span><span class="line"><span class="cl">0xfffffffe in ?? <span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> file ~/Downloads/Infinitime/1.2.0/merged-internal.hex
</span></span><span class="line"><span class="cl">A program is being debugged already.
</span></span><span class="line"><span class="cl">Are you sure you want to change the file? <span class="o">(</span>y or n<span class="o">)</span> y
</span></span><span class="line"><span class="cl">Reading symbols from ~/Downloads/Infinitime/1.2.0/merged-internal.hex...
</span></span><span class="line"><span class="cl"><span class="o">(</span>No debugging symbols found in ~/Downloads/Infinitime/1.2.0/merged-internal.hex<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> load
</span></span><span class="line"><span class="cl">Loading section .sec1, size 0x54a0 lma 0x0
</span></span><span class="line"><span class="cl">Loading section .sec2, size 0x8000 lma 0x8000
</span></span><span class="line"><span class="cl">Loading section .sec3, size 0x10000 lma 0x10000
</span></span><span class="line"><span class="cl">Loading section .sec4, size 0x10000 lma 0x20000
</span></span><span class="line"><span class="cl">Loading section .sec5, size 0x10000 lma 0x30000
</span></span><span class="line"><span class="cl">Loading section .sec6, size 0x10000 lma 0x40000
</span></span><span class="line"><span class="cl">Loading section .sec7, size 0x9970 lma 0x50000
</span></span><span class="line"><span class="cl">Start address 0x00000000, load size <span class="m">355856</span>
</span></span><span class="line"><span class="cl">Transfer rate: <span class="m">39</span> KB/sec, <span class="m">969</span> bytes/write.
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> compare-sections
</span></span><span class="line"><span class="cl">Section .sec1, range 0x0 -- 0x54a0: matched.
</span></span><span class="line"><span class="cl">Section .sec2, range 0x8000 -- 0x10000: matched.
</span></span><span class="line"><span class="cl">Section .sec3, range 0x10000 -- 0x20000: matched.
</span></span><span class="line"><span class="cl">Section .sec4, range 0x20000 -- 0x30000: matched.
</span></span><span class="line"><span class="cl">Section .sec5, range 0x30000 -- 0x40000: matched.
</span></span><span class="line"><span class="cl">Section .sec6, range 0x40000 -- 0x50000: matched.
</span></span><span class="line"><span class="cl">Section .sec7, range 0x50000 -- 0x59970: matched.
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> mon hard_srst
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> detach
</span></span><span class="line"><span class="cl">Detaching from program: /home/lopeztel/Downloads/Infinitime/1.2.0/merged-internal.hex, Remote target
</span></span><span class="line"><span class="cl"><span class="p">&amp;</span><span class="c1">#91;Inferior 1 (Remote target) detached]</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> quit
</span></span></code></pre></td></tr></table>
</div>
</div><p>After consulting with the guys at the <a href="https://matrix.to/#/#pinetime-dev:matrix.org">PineTime-dev Matrix channel</a>, I was glad to confirm I was flashing the right file: merged-internal.hex from the <a href="https://github.com/JF002/InfiniTime/releases/tag/1.2.0">releases page</a> in <a href="https://github.com/JF002/InfiniTime">InfiniTime github repo</a> actually contains both the bootloader and the application firmware in a single file, so no complaints there…</p>
<p>But, someone also pointed out that the first devices to ship had locked bootloaders, so turns out I had to unlock it with a Segger J-Link Debug Probe (aka <a href="https://infocenter.nordicsemi.com/index.jsp?topic=%2Fug_nrf52832_dk%2FUG%2Fnrf52_DK%2Fintro.html">NRF52DK</a> I had around here)</p>
<p>Pin connections:<!-- raw HTML omitted --></p>
<table>
<thead>
<tr>
<th>Pin on PineTime</th>
<th>Pin on NRF52DK P20</th>
</tr>
</thead>
<tbody>
<tr>
<td>SWDIO</td>
<td>SWDIO</td>
</tr>
<tr>
<td>SWDCLK</td>
<td>SWDCLK</td>
</tr>
<tr>
<td>3.3V VCC</td>
<td>VTG</td>
</tr>
<tr>
<td>GND</td>
<td>GND DETECT</td>
</tr>
</tbody>
</table>
<p>Then it was just a matter of issuing a couple of <a href="https://www.nordicsemi.com/Products/Development-tools/nrf-command-line-tools">nrfjprog</a> commands as stated in the wiki article <a href="https://wiki.pine64.org/wiki/Reprogramming_the_PineTime#STM32_.28Blue_Pill.29">Reprogramming the PineTime</a>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-1-1"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-1-1">1</a>
</span><span class="lnt" id="hl-1-2"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-1-2">2</a>
</span><span class="lnt" id="hl-1-3"><a style="outline: none; text-decoration:none; color:inherit" href="#hl-1-3">3</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">nrfjprog -f NRF52 --recover
</span></span><span class="line"><span class="cl">nrfjprog -f NRF52 --program &lt;path-to-hex&gt;/merged-internal.hex --sectorerase
</span></span><span class="line"><span class="cl">nrfjprog -f NRF42 -f NRF52 --reset
</span></span></code></pre></td></tr></table>
</div>
</div><p>Which finally did the trick:</p>
<p><img loading="lazy" src="https://lopeztel.noho.st/piwigo/_data/i/galleries/blog_media/20210624-105138-me.jpg#center" alt=""  />
</p>
<p>Now, I only need to do something about the stuck button…I attempted to seal the device with superglue and it spilled everywhere</p>
<p>Huge shoutout to the nice people in the PineTime-dev Matrix channel, they were very patient and helpful!</p>
<hr>
<p>Day 14 of my 2020’s <a href="https://lopeztel.xyz/blog/tags/100daystooffload/">#100DaysToOffload</a></p>
<p>Join <a href="https://100daystooffload.com/">100DaysToOffload</a>!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lopeztel.xyz/blog/tags/100daystooffload/">100DaysToOffload</a></li>
      <li><a href="https://lopeztel.xyz/blog/tags/nrf52/">nRF52</a></li>
      <li><a href="https://lopeztel.xyz/blog/tags/pinetime/">pinetime</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lopeztel.xyz/blog/2021/07/01/rgb-wifi-enabled-lamp-part-2/">
    <span class="title">« Prev</span>
    <br>
    <span>RGB WiFi enabled lamp (Part 2)</span>
  </a>
  <a class="next" href="https://lopeztel.xyz/blog/2021/06/24/rgb-wifi-enabled-lamp-part-1/">
    <span class="title">Next »</span>
    <br>
    <span>RGB WiFi enabled lamp (Part 1)</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://lopeztel.xyz/blog">Lopeztel&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
